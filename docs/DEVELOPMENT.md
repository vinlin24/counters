# Development Details

## Environment Recovery

This project makes use of an `.env` file to store sensitive values as
environment variables. The required keys are:

- `DISCORD_EMAIL`
- `DISCORD_PASSWORD`
- `INSTAGRAM_USERNAME`
- `INSTAGRAM_PASSWORD`
- `SPOTIFY_CLIENT_ID`
- `SPOTIFY_CLIENT_SECRET`
- `SPOTIFY_USER_REFRESH`
- `GITHUB_PROFILE_URL`
- `GITHUB_EMAIL`
- `GITHUB_PASSWORD `
- `ERROR_EMAIL`
- `ERROR_EMAIL_PASSWORD`

You should obviously know your own email, username, and password credentials.
`GITHUB_PROFILE_URL` happens to be https://github.com/vinlin24 for me.
`ERROR_EMAIL` and `ERROR_EMAIL_PASSWORD` is the email and password to send and
receive error reports.

`SPOTIFY_CLIENT_ID` and `SPOTIFY_CLIENT_SECRET` can be found/regenerated for
your application on the [Spotify Developer
Dashboard](https://developer.spotify.com/dashboard/applications). The user
refresh token, `SPOTIFY_USER_REFRESH`, can be regenerated by running a throwaway
script:

```python
# pip install tekore
import tekore

CLIENT_ID = "SPOTIFY CLIENT ID"
CLIENT_SECRET = "SPOTIFY CLIENT SECRET"
token = tekore.request_client_token(CLIENT_ID, CLIENT_SECRET)

# This is your refresh token, save it somewhere
print(token.refresh_token)
```

The state of the project virtual environment is maintained in
[requirements.txt](../requirements.txt). You can recreate the environment like
you normally would:
```
python -m venv .venv
.venv/Scripts/activate
pip install -r requirements.txt
```

See [Usage](../README.md#usage) for how to run the package.

> In VS Code, you can include the special `$schema` key in `bios.json` and set
> it to the path of `bios.json.schema` to validate it with IntelliSense.
> Supposedly you can validate without modifying the JSON itself [by using
> settings](https://code.visualstudio.com/docs/languages/json#_json-schemas-and-settings),
> but I couldn't get it to work - `fileMatch` or `url` or both just wasn't
> picking up the right paths.

## Implementation Details

The Spotify part uses the
[tekore](https://tekore.readthedocs.io/en/stable/index.html) library as a
wrapper for the [Spotify Web
API](https://developer.spotify.com/documentation/web-api/). This is a robust and
actively maintained library, so I do not worry much about having to modify this
part of the code.

The Discord and Instagram parts use
[Selenium](https://selenium-python.readthedocs.io/) webscraping to navigate the
respective web applications and update my user status/bio since they lack APIs
that support such an action. The problem with this is that their implementations
risk breaking every update because they rely on XPaths and CSS selectors of web
elements that can change unexpectedly. For example, the XPaths found in my
original [discord_profile.py](../standalones/discord_profile.py) are no longer
applicable.

Updated: If an error in any part of the main process is raised, it is compiled
in an email sent to myself in addition to logging it to the log file.

Don't forget to update the [JSON schema](../README.md#configuration) part of
this documentation if you choose to add new features that affect it.
